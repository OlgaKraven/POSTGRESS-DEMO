# –ú–æ–¥—É–ª—å 2. –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ ER-–¥–∏–∞–≥—Ä–∞–º–º–µ (PostgreSQ —á–µ—Ä–µ–∑ PgAdmin)

**–¶–µ–ª—å:** —Å–æ–∑–¥–∞—Ç—å –ë–î –∏ —Ç–∞–±–ª–∏—Ü—ã –ø–æ ER, –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å PK/FK/–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è, –∑–∞—Ç–µ–º –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å `–ó–∞–∫–∞–∑—á–∏–∫–∏.json`.

---

## 0. –í–∞–∂–Ω–æ –ø–µ—Ä–µ–¥ —Å—Ç–∞—Ä—Ç–æ–º

* –í–µ–∑–¥–µ –Ω–∏–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–æ–¥–∏–Ω –≤–∞—Ä–∏–∞–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**: **–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä (pgAdmin GUI)**

* –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞: —Å—Ö–µ–º–∞ `app` (—á—Ç–æ–±—ã –æ—Ç–¥–µ–ª–∏—Ç—å –æ—Ç `public`).

---

## 1. –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

 
1. –û—Ç–∫—Ä–æ–π—Ç–µ **pgAdmin** ‚Üí –ø–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É.

   ![–ø–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É](../assets/images/2.png)

   /// caption
   –†–∏—Å—É–Ω–æ–∫ 1 ‚Äì –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É
   ///

2. –ü—Ä–∞–≤—ã–π –∫–ª–∏–∫ –ø–æ **Databases** ‚Üí **Create ‚Üí Database‚Ä¶**

3. `Database`: `dairy_demo` (–∏–ª–∏ –∏–º—è –ø–æ –∑–∞–¥–∞–Ω–∏—é)

4. Owner: –≤–∞—à –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)

5. Save.

   ![–ø–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É](../assets/images/3.png)

   /// caption
   –†–∏—Å—É–Ω–æ–∫ 2 ‚Äì –°–æ–∑–¥–∞–Ω–∏–µ –ë–î
   ///

–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:

* pgAdmin: –≤—ã–±—Ä–∞—Ç—å –ë–î –≤ –¥–µ—Ä–µ–≤–µ

---

## 2. –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ö–µ–º—ã (namespace) `app`


1. –í –¥–µ—Ä–µ–≤–µ: **Schemas** ‚Üí **Create ‚Üí Schema‚Ä¶**

   ![–í –¥–µ—Ä–µ–≤–µ: Schemas ‚Üí Create ‚Üí Schema‚Ä¶](../assets/images/4.png)

   /// caption
   –†–∏—Å—É–Ω–æ–∫ 3 ‚Äì –í –¥–µ—Ä–µ–≤–µ: **Schemas** ‚Üí **Create ‚Üí Schema‚Ä¶**
   ///

2. Name: `app`

3. Owner: –≤–∞—à –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

4. Save.

   ![app](../assets/images/5.png)

   /// caption
   –†–∏—Å—É–Ω–æ–∫ 4 ‚Äì app
   ///

---

## 3. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –ø–æ ER-–¥–∏–∞–≥—Ä–∞–º–º–µ (—á–µ—Ä–µ–∑ GUI)

> –ù–∏–∂–µ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏. –î–ª—è –∫–∞–∂–¥–æ–π ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä.

---

### 3.1. COUNTERPARTY (–ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç)


1. **Schemas ‚Üí app ‚Üí Tables ‚Üí Create ‚Üí Table‚Ä¶**


    ![**Schemas ‚Üí app ‚Üí Tables ‚Üí Create ‚Üí Table‚Ä¶**](../assets/images/6.png)

    /// caption 
    –†–∏—Å—É–Ω–æ–∫ 5 ‚Äì **Schemas ‚Üí app ‚Üí Tables ‚Üí Create ‚Üí Table‚Ä¶**
    ///


2. Name: `counterparty`

      ![counterparty](../assets/images/7.png)

      /// caption
      –†–∏—Å—É–Ω–æ–∫ 6 ‚Äì counterparty
      ///

3. –í–∫–ª–∞–¥–∫–∞ **Columns** ‚Üí –¥–æ–±–∞–≤—å—Ç–µ:

      ![–í–∫–ª–∞–¥–∫–∞ Columns](../assets/images/8.png)

      /// caption
      –†–∏—Å—É–Ω–æ–∫ 7 ‚Äì –í–∫–ª–∞–¥–∫–∞ **Columns**
      ///

   –°–æ–∑–¥–∞–π—Ç–µ:

   * `id` type: `text`, **Primary Key**
   * `name` type: `text`, **Not null**
   * `inn` type: `text`
   * `address` type: `text`
   * `phone` type: `text`
   * `is_salesman` type: `boolean`, default: `false`, **Not null**
   * `is_buyer` type: `boolean`, default: `false`, **Not null**

     ![–í–∫–ª–∞–¥–∫–∞ Columns](../assets/images/9.png)

     /// caption
     –†–∏—Å—É–Ω–æ–∫ 8 ‚Äì –í–∫–ª–∞–¥–∫–∞ **Columns**
     ///

4. –í–∫–ª–∞–¥–∫–∞ **Constraints** ‚Üí Primary Key –Ω–∞ `id`

5. Save.

   ![–í–∫–ª–∞–¥–∫–∞ Constraints ‚Üí Primary Key –Ω–∞ id](../assets/images/10.png)

   /// caption
   –†–∏—Å—É–Ω–æ–∫ 9 ‚Äì –í–∫–ª–∞–¥–∫–∞ **Constraints** ‚Üí Primary Key –Ω–∞ `id`
   ///

---

### 3.2. ITEM (–ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞)


1. Create ‚Üí Table‚Ä¶ Name: `item`

2. Columns:

      * `id` type: `bigserial`, **PK**
      * `code` type: `text`, Unique (—Å–º. Constraints)
      * `name` type: `text`, Not null
      * `item_type` type: `text`, Not null
      * `unit_default` type: `text`

3. Constraints:

      * Primary Key: `id`
      * Unique: `code`

4. Check constraint (–≤–∫–ª–∞–¥–∫–∞ Constraints ‚Üí Check):

      * Name: `chk_item_type`
      * Expression: `item_type IN ('product','material')`

5. Save.

---

### 3.3. PRICE (–ü—Ä–∞–π—Å-–ª–∏—Å—Ç)


1. Create table `price`

2. Columns:

      * `id` bigserial PK
      * `item_id` bigint Not null
      * `price` numeric(12,2) Not null
      * `effective_from` date (optional)
      * `effective_to` date (optional)

3. Foreign Keys:

      * `item_id` ‚Üí `app.item(id)`
      * On update: CASCADE
      * On delete: RESTRICT

4. Check constraints:

      * `price >= 0`
      * `effective_to IS NULL OR effective_from IS NULL OR effective_to >= effective_from`

5. Save.

---

### 3.4. SPECIFICATION –∏ SPECIFICATION_MATERIAL

#### SPECIFICATION


1. Table `specification`

2. Columns:

      * `id` bigserial PK
      * `name` text Not null
      * `product_item_id` bigint Not null
      * `output_qty` numeric(12,3) Not null default 1
      * `output_unit` text
      * `manufacturer_id` text

3. FK:

      * `product_item_id` ‚Üí `app.item(id)` (RESTRICT)
      * `manufacturer_id` ‚Üí `app.counterparty(id)` (RESTRICT)

4. Check: `output_qty > 0`

5. Save.

#### SPECIFICATION_MATERIAL


1. Table `specification_material`

2. Columns:

      * `id` bigserial PK
      * `specification_id` bigint Not null
      * `material_item_id` bigint Not null
      * `qty` numeric(12,3) Not null
      * `unit` text

3. FK:

      * `specification_id` ‚Üí `app.specification(id)` ON DELETE CASCADE
      * `material_item_id` ‚Üí `app.item(id)` ON DELETE RESTRICT

4. Unique constraint:

      * `(specification_id, material_item_id)`

5. Check: `qty > 0`

6. Save.

---

### 3.5. PRODUCTION_ORDER, PRODUCTION_PRODUCT_LINE, PRODUCTION_MATERIAL_LINE


–°–æ–∑–¥–∞–π—Ç–µ —Ç—Ä–∏ —Ç–∞–±–ª–∏—Ü—ã –ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏:

   * —Å–Ω–∞—á–∞–ª–∞ `production_order` (PK),
   * –∑–∞—Ç–µ–º `production_product_line` –∏ `production_material_line` (FK –Ω–∞ `production_order` –∏ `item`),
   * –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤—ã—Å—Ç–∞–≤—å—Ç–µ `ON DELETE CASCADE` –Ω–∞ —Å—Ç—Ä–æ–∫–∞—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞.

---

### 3.6. CUSTOMER_ORDER –∏ CUSTOMER_ORDER_LINE


   * `customer_order`: –ø–æ–ª—è —à–∞–ø–∫–∏ + –¥–≤–∞ FK –Ω–∞ `counterparty`
   * `customer_order_line`: FK –Ω–∞ `customer_order` (CASCADE) + FK –Ω–∞ `item`

---

### 3.7. COST_CALCULATION –∏ COST_CALCULATION_LINE


–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ: ‚Äú—à–∞–ø–∫–∞‚Äù + ‚Äú—Å—Ç—Ä–æ–∫–∏‚Äù, –Ω–∞ —Å—Ç—Ä–æ–∫–∞—Ö `ON DELETE CASCADE`.

---

## 4. –ò–º–ø–æ—Ä—Ç `–ó–∞–∫–∞–∑—á–∏–∫–∏.json`

### (—á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã pgAdmin)

–ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ **pgAdmin –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø—Ä—è–º–æ–π –∏–º–ø–æ—Ä—Ç JSON-—Ñ–∞–π–ª–∞ —Å—Ä–∞–∑—É –≤ –∫–æ–ª–æ–Ω–∫–∏ —Ç–∞–±–ª–∏—Ü—ã** (–≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç CSV). –ü–æ—ç—Ç–æ–º—É –∏–º–ø–æ—Ä—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è **–≤ –¥–≤–∞ —ç—Ç–∞–ø–∞**:

1. –∑–∞–≥—Ä—É–∑–∫–∞ JSON —Ü–µ–ª–∏–∫–æ–º –≤–æ –≤—Ä–µ–º–µ–Ω–Ω—É—é (–ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—É—é) —Ç–∞–±–ª–∏—Ü—É;
2. —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∞ JSON –∏ –ø–µ—Ä–µ–Ω–æ—Å –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–∞–±–æ—á—É—é —Ç–∞–±–ª–∏—Ü—É `counterparty`.

---

### 4.1. –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã `counterparty_import`

1. –í –¥–µ—Ä–µ–≤–µ pgAdmin –æ—Ç–∫—Ä–æ–π—Ç–µ:

      **Schemas ‚Üí app ‚Üí Tables ‚Üí Create ‚Üí Table‚Ä¶**

2. –£–∫–∞–∂–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–∞–±–ª–∏—Ü—ã:

      * **Name:** `counterparty_import`
      * **Schema:** `app`

3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **Columns** –∏ —Å–æ–∑–¥–∞–π—Ç–µ –∫–æ–ª–æ–Ω–∫—É:

      * **Name:** `payload`
      * **Data type:** `jsonb`
      * **Not null:** ‚úî (–≤–∫–ª—é—á–µ–Ω–æ)

4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É (**Save**).

> –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã `counterparty_import` ‚Äî –≤—Ä–µ–º–µ–Ω–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å **–∏—Å—Ö–æ–¥–Ω—ã–π JSON —Ü–µ–ª–∏–∫–æ–º**, –±–µ–∑ —Ä–∞–∑–±–æ—Ä–∫–∏ –ø–æ –ø–æ–ª—è–º.

---

### 4.2. –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ñ–∞–π–ª–∞ `–ó–∞–∫–∞–∑—á–∏–∫–∏.json` –≤ —Ç–∞–±–ª–∏—Ü—É

1. –û—Ç–∫—Ä–æ–π—Ç–µ **Query Tool**:

     * –ø—Ä–∞–≤—ã–π –∫–ª–∏–∫ –ø–æ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ —Å—Ö–µ–º–µ `app` ‚Üí **Query Tool**

2. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `–ó–∞–∫–∞–∑—á–∏–∫–∏.json` –≤ –ª—é–±–æ–º —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ
   (–Ω–∞–ø—Ä–∏–º–µ—Ä, Notepad++, VS Code).

3. **–í—ã–¥–µ–ª–∏—Ç–µ –∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–µ—Å—å —Ñ–∞–π–ª —Ü–µ–ª–∏–∫–æ–º**, –≤–∫–ª—é—á–∞—è:

      * –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ —Å–∫–æ–±–∫–∏ `[` `]`,
      * –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã,
      * –≤—Å–µ –∑–∞–ø—è—Ç—ã–µ –∏ –∫–∞–≤—ã—á–∫–∏.

4. –í Query Tool –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –≤—Å—Ç–∞–≤–∫–∏:

```sql
INSERT INTO app.counterparty_import ("payload ")
VALUES (
$$ '<–≤—Å—Ç–∞–≤—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ JSON —Ü–µ–ª–∏–∫–æ–º>'$$::jsonb
);
```

–¢–µ–∫—Å—Ç –∏–∑ –ó–∞–∫–∞–∑—á–∏–∫–∏.json –≤—Å—Ç–∞–≤–ª—è–µ–º –≤–º–µ—Å—Ç–æ: <–≤—Å—Ç–∞–≤—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ JSON —Ü–µ–ª–∏–∫–æ–º>

5. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∑–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω–∏–ª—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
   (—Å–æ–æ–±—â–µ–Ω–∏–µ `INSERT 0 1` –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–µ).

6. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:

```sql
SELECT payload
FROM app.counterparty_import;
```

> –ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ **–≤ —Ç–∞–±–ª–∏—Ü–µ –æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞**, –∞ –≤ –ø–æ–ª–µ `payload` —Ö—Ä–∞–Ω–∏—Ç—Å—è **–≤–µ—Å—å JSON-–º–∞—Å—Å–∏–≤**.

---

### 4.3. –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ JSON –∏ –ø–µ—Ä–µ–Ω–æ—Å –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–∞–±–ª–∏—Ü—É `counterparty`

–§–∞–π–ª `–ó–∞–∫–∞–∑—á–∏–∫–∏.json`, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, —Å–æ–¥–µ—Ä–∂–∏—Ç **–º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤**, –Ω–∞–ø—Ä–∏–º–µ—Ä:

```json
[
  {
    "id": "C001",
    "name": "–û–û–û –†–æ–º–∞—à–∫–∞",
    "inn": "7701234567",
    "address": "–≥. –ú–æ—Å–∫–≤–∞",
    "phone": "+7..."
  },
  ...
]
```

–ß—Ç–æ–±—ã –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –∫–∞–∂–¥—ã–π –æ–±—ä–µ–∫—Ç –º–∞—Å—Å–∏–≤–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é —Å—Ç—Ä–æ–∫—É —Ç–∞–±–ª–∏—Ü—ã `counterparty`, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è `jsonb_array_elements`.

1. –í **Query Tool** –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–ø—Ä–æ—Å —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∏:

```sql
INSERT INTO app.counterparty (
    id,
    name,
    inn,
    address,
    phone,
    is_salesman,
    is_buyer
)
SELECT
    e->>'id'        AS id,
    e->>'name'      AS name,
    NULLIF(e->>'inn', '') AS inn,
    NULLIF(
        COALESCE(e->>'addres', e->>'address'),
        ''
    )               AS address,
    NULLIF(e->>'phone', '') AS phone,
    COALESCE((e->>'salesman')::BOOLEAN, FALSE) AS is_salesman,
    COALESCE((e->>'buyer')::BOOLEAN, FALSE)    AS is_buyer
FROM (
    SELECT jsonb_array_elements(payload) AS e
    FROM app.counterparty_import
) t;
```

2. –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π:

      * `jsonb_array_elements(payload)` ‚Äî —Ä–∞–∑–±–∏–≤–∞–µ—Ç JSON-–º–∞—Å—Å–∏–≤ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã;
      * `e->>'field'` ‚Äî –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª—è –∫–∞–∫ —Ç–µ–∫—Å—Ç;
      * `NULLIF(..., '')` ‚Äî –∑–∞–º–µ–Ω—è–µ—Ç –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ –Ω–∞ `NULL`;
      * `COALESCE(...)` ‚Äî –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –µ—Å–ª–∏ –ø–æ–ª–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç;
      * –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ `::BOOLEAN` ‚Äî –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è.

---

### 4.4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∏–º–ø–æ—Ä—Ç–∞

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å—Ç—Ä–æ–∫–∏ –ø–æ—è–≤–∏–ª–∏—Å—å –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ:

```sql
SELECT COUNT(*) 
FROM app.counterparty;
```

2. –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–µ–π:

```sql
SELECT *
FROM app.counterparty
ORDER BY id
LIMIT 10;
```

3. –¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å pgAdmin:

   * –ø—Ä–∞–≤—ã–π –∫–ª–∏–∫ –ø–æ —Ç–∞–±–ª–∏—Ü–µ `counterparty`
   * **View/Edit Data ‚Üí All Rows**

---

### 4.5. –û—á–∏—Å—Ç–∫–∞ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã (–ø–æ –∂–µ–ª–∞–Ω–∏—é)

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å:

* –æ—á–∏—â–µ–Ω–∞:

```sql
TRUNCATE TABLE app.counterparty_import;
```

* –∏–ª–∏ –æ—Å—Ç–∞–≤–ª–µ–Ω–∞ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∏–º–ø–æ—Ä—Ç–æ–≤ / –æ—Ç–ª–∞–¥–∫–∏.

---

### 4.6. –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ

> –ï—Å–ª–∏ —Ñ–∞–π–ª `–ó–∞–∫–∞–∑—á–∏–∫–∏.json` **–æ—á–µ–Ω—å –±–æ–ª—å—à–æ–π**, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É —á–µ—Ä–µ–∑ `psql \copy`, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–µ–µ –∏ –Ω–∞–¥—ë–∂–Ω–µ–µ.
> –û–¥–Ω–∞–∫–æ –≤ —Ä–∞–º–∫–∞—Ö –¥–∞–Ω–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ **—Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω —Ç–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å pgAdmin –∏ Query Tool**, –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏.

---

### 4.7. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –±–µ–∑ –∫–æ–¥–∞: –∏–º–ø–æ—Ä—Ç —á–µ—Ä–µ–∑ CSV

*(pgAdmin Import/Export)*

pgAdmin –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∏–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö **–∏–∑ CSV-—Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**, –Ω–æ **–Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø—Ä—è–º–æ–π –∏–º–ø–æ—Ä—Ç JSON**.
–ü–æ—ç—Ç–æ–º—É –Ω–∞–∏–±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–æ–π –∏ ¬´–±–µ–∑–∫–æ–¥–æ–≤–æ—á–Ω—ã–π¬ª —Å–ø–æ—Å–æ–± ‚Äî **–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å JSON –≤ CSV** –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∏–º–ø–æ—Ä—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏ pgAdmin.

#### –®–∞–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

1. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `–ó–∞–∫–∞–∑—á–∏–∫–∏.json` –≤ —Ñ–æ—Ä–º–∞—Ç `–ó–∞–∫–∞–∑—á–∏–∫–∏.csv`.

   –î–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:

   * Microsoft Excel (—á–µ—Ä–µ–∑ Power Query);
   * LibreOffice Calc;
   * –ª—é–±–æ–≥–æ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏.

   –í CSV-—Ñ–∞–π–ª–µ –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –¥–æ–ª–∂–Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å **–æ–¥–Ω–æ–º—É –∑–∞–∫–∞–∑—á–∏–∫—É**, –∞ –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ ‚Äî –ø–æ–ª—è–º —Ç–∞–±–ª–∏—Ü—ã `counterparty`.

2. –í pgAdmin –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∏–º–ø–æ—Ä—Ç:

   * –ø—Ä–∞–≤—ã–π –∫–ª–∏–∫ –ø–æ —Ç–∞–±–ª–∏—Ü–µ **`app.counterparty`**;
   * –≤—ã–±–µ—Ä–∏—Ç–µ **Import/Export Data‚Ä¶**;
   * –≤–∫–ª–∞–¥–∫–∞ **Import**;
   * —É–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É `–ó–∞–∫–∞–∑—á–∏–∫–∏.csv`;
   * —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ñ–ª–∞–≥ **Header** (–µ—Å–ª–∏ –ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∏);
   * –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–¥–∏—Ä–æ–≤–∫—É (–æ–±—ã—á–Ω–æ `UTF-8`);
   * –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å (`;` –∏–ª–∏ `,`);
   * –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –∏–º–ø–æ—Ä—Ç (**OK**).

3. –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–º–ø–æ—Ä—Ç–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

```sql
SELECT COUNT(*)
FROM app.counterparty;
```

#### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Å–ø–æ—Å–æ–±–∞

* –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SQL (—Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç);
* –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å;
* —É—Å—Ç–æ–π—á–∏–≤–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –±–æ–ª—å—à–∏–º–∏ –æ–±—ä—ë–º–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö.

#### –ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫

* —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ñ–∞–π–ª–∞ JSON –≤ CSV.

---

### 4.8. –ú–∏–Ω–∏–º—É–º –∫–æ–¥–∞, –Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∏–º–ø–æ—Ä—Ç —Ñ–∞–π–ª–∞: PSQL Tool (`\copy`)

–î–∞–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± —Å–æ—á–µ—Ç–∞–µ—Ç **–Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å** –∏ **–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–±—ä—ë–º –∫–æ–º–∞–Ω–¥**, –Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è **—á–µ—Ä–µ–∑ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π PSQL Tool pgAdmin**, –∞ –Ω–µ —á–µ—Ä–µ–∑ Query Tool.

#### –®–∞–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

1. –í pgAdmin –æ—Ç–∫—Ä–æ–π—Ç–µ –º–µ–Ω—é **Tools ‚Üí PSQL Tool**.
2. –í –æ—Ç–∫—Ä—ã–≤—à–µ–º—Å—è —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É:

```sql
\copy app.counterparty_import(payloadjsonb)
FROM 'C:/path/to/–ó–∞–∫–∞–∑—á–∏–∫–∏.json'
WITH (FORMAT text);
```

> –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è **–Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞**, —Ç–æ –µ—Å—Ç—å –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ, –≥–¥–µ –∑–∞–ø—É—â–µ–Ω pgAdmin.

3. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ **—Ä–∞—Å–ø–∞–∫–æ–≤–∫—É JSON** –≤ —Ç–∞–±–ª–∏—Ü—É `counterparty`
   (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–∞–ø—Ä–æ—Å –∏–∑ –ø—É–Ω–∫—Ç–∞ **4.3**).

#### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Å–ø–æ—Å–æ–±–∞

* —Å–∞–º—ã–π –Ω–∞–¥—ë–∂–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –¥–ª—è —Ñ–∞–π–ª–æ–≤ JSON;
* –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –±–æ–ª—å—à–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏;
* –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ SQL-–∫–æ–¥–∞.

#### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ

* –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–Ω—ã–π —Ä–µ–∂–∏–º (`psql`), —á—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–ø—Ä–µ—â–µ–Ω–æ –∏–ª–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —É—á–µ–±–Ω—ã—Ö —Å—Ä–µ–¥–∞—Ö.

---

## 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤–æ–µ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–≤–æ–π –ë–î –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü —Å–æ–∑–¥–∞–π—Ç–µ ER-–¥–∏–∞–≥–∞–º–º—É —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏ Postgress –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è, —á—Ç–æ –≤—ã –Ω–∏—á–µ–≥–æ –Ω–µ –∑–∞–±—ã–ª–∏. 

### 5.1. –í—ã–±—Ä–∞—Ç—å –ë–î

–ù–∞–∂–∏–º–∏—Ç–µ –Ω–∞ —Å–≤–æ–µ–π –ë–î –ø—Ä–∞–≤–æ–π –∫–ª–∞–≤–∏—à–µ–π –º—ã—à–∏. 

   ![–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤–æ–µ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö](../assets/images/11.png)

   /// caption
   –†–∏—Å—É–Ω–æ–∫ 10 ‚Äì –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤–æ–µ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
   ///

### 5.2. –°–æ–∑–¥–∞–Ω–∏–µ ER-–¥–∏–∞–≥—Ä–∞–º–º—ã


   ![–°–æ–∑–¥–∞–Ω–∏–µ ER-–¥–∏–∞–≥—Ä–∞–º–º—ã](../assets/images/12.png)

   /// caption
   –†–∏—Å—É–Ω–æ–∫ 11 ‚Äì –°–æ–∑–¥–∞–Ω–∏–µ ER-–¥–∏–∞–≥—Ä–∞–º–º—ã
   ///

### 5.3. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∏–∞–≥—Ä–∞–º–º—ã

–î–∏–∞–≥—Ä–∞–º–º—É –º–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä—è–¥–æ–º —Å –≤–∞—à–∏–º ER, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã —Å–æ–∑–¥–∞–ª–∏ –≤ –Ω–∞—á–∞–ª–µ —ç–∫–∑–∞–º–µ–Ω–∞ —Å –∏–º–µ–Ω–µ–º expodt_db.

   ![–°–æ–∑–¥–∞–Ω–∏–µ ER-–¥–∏–∞–≥—Ä–∞–º–º—ã](../assets/files/test.pgerd.png)

   /// caption
   –†–∏—Å—É–Ω–æ–∫ 12 ‚Äì –ü—Ä–∏–º–µ—Ä —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π –¥–∏–∞–≥—Ä–∞–º–º—ã
   ///

## 6. –°–∫–∞—á–∞—Ç—å –ø—Ä–∏–º–µ—Ä –≥–æ—Ç–æ–≤–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

- `dairy_demo.sql`

üëâ [dairy_demo.sql](../assets/files//dairy_demo.sql)
 
